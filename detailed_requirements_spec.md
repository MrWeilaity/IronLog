# 《IronLog (铁律)：全方位运动健康管理平台》详细需求规格说明书 (Detailed Requirements Specification)

**文档版本**: V1.0
**文档密级**: 内部公开
**编写日期**: 2023-10-27
**编写人**: 资深 Java Web 架构师 (Jules)
**项目代号**: IronLog
**技术栈**: Spring Boot (后端) + MySQL (数据库) + Vue 3 (前端)

---

## 1. 引言 (Introduction)

### 1.1 编写目的
本详细需求规格说明书旨在明确“IronLog (铁律)”运动健康管理平台的各项功能细节、业务逻辑及交互要求。本文档将作为系统设计、数据库建模、前后端开发及测试验收的唯一基准依据。

### 1.2 预期读者
*   后端开发工程师
*   前端开发工程师
*   UI/UX 设计师
*   测试工程师
*   项目经理

---

## 2. 系统功能架构 (System Functional Architecture)

本系统核心划分为六大功能模块，旨在覆盖用户“练、吃、管、看、比”的全生命周期健康管理需求。

### 功能模块树概览
1.  **仪表盘 (Dashboard)**：数据驾驶舱、快捷入口、消息通知。
2.  **训练中心 (Training Center)**：动作知识库、智能排程引擎、高阶日志记录。
3.  **营养膳食 (Nutrition)**：宏量营养素追踪、热量差计算、食物数据库。
4.  **日程日历 (Schedule)**：可视化训练流、补签管理、状态追踪。
5.  **社区与激励 (Social & Incentives)**：排行榜逻辑、成就勋章系统。
6.  **后台管理 (Admin)**：RBAC权限、内容风控、数据运维、审计追踪。

---

## 3. 功能模块详细描述 (Detailed Functional Requirements)

### 3.1 仪表盘 (Dashboard)

**功能定义**：用户登录后的首屏，作为全局数据的聚合展示中心和高频操作的快捷入口。

#### 3.1.1 今日待办看板 (Daily Task Board)
*   **功能描述**：根据用户设定的计划，动态展示今日需要完成的任务（训练任务 + 饮食记录任务）。
*   **页面元素**：
    *   **进度环**：今日已完成项/总项数的百分比环形图。
    *   **任务列表**：
        *   训练卡片：显示“今日部位（如：胸肌）”及状态（未开始/进行中/已完成）。
        *   饮食卡片：显示“剩余可摄入热量”及“还需记录的餐次”。
*   **交互逻辑**：点击卡片直接跳转至对应的“训练日志录入”或“饮食记录”页面。

#### 3.1.2 身体核心指标概览 (Body Metrics Widget)
*   **功能描述**：展示用户当前的身体状态快照。
*   **数据项**：
    *   **BMI 指数**：根据最新录入的身高体重自动计算，并标注区间（偏瘦/正常/超重/肥胖）。计算公式：$Weight(kg) / Height(m)^2$。
    *   **体重变化趋势**：显示近7天体重折线微图 (Sparkline)。
*   **逻辑处理**：若用户超过7天未更新体重，显示“数据陈旧”红色小点提示。

#### 3.1.3 本周运动统计 (Weekly Activity Stats)
*   **功能描述**：通过 ECharts/Chart.js 柱状图展示本周每日的训练时长。
*   **统计维度**：X轴为日期（周一至周日），Y轴为分钟数。
*   **汇总数据**：图表上方显示“本周累计时长”和“本周累计训练吨位（总容量）”。

#### 3.1.4 系统公告栏 (System Announcements)
*   **功能描述**：轮播展示管理员发布的最新通知（如：服务器维护、新功能上线、健身科普文章）。
*   **交互**：点击公告标题弹出模态框显示富文本详情。

---

### 3.2 训练中心 (Training Center)

#### 3.2.1 动作库 (Exercise Library)
*   **功能描述**：标准化的健身动作字典，是所有训练计划的基础。
*   **查询功能**：
    *   **模糊搜索**：支持输入动作名称（如“卧推”）或别名进行检索。
    *   **多维筛选**：
        *   按部位：胸、背、腿、肩、手臂、核心。
        *   按器械：杠铃、哑铃、固定器械、自重。
        *   按难度：初级、中级、高级。
*   **详情展示**：
    *   **GIF 演示**：自动循环播放标准动作示范。
    *   **要点文字**：结构化展示“起始姿势”、“动作过程”、“呼吸要领”。
    *   **肌肉解剖图**：高亮显示主修肌肉和辅修肌肉。

#### 3.2.2 智能计划生成器 (AI Planner)
*   **功能描述**：基于规则引擎的半自动化排程系统。
*   **输入表单**：
    *   **训练目标**：增肌（Hypertrophy）、减脂（Fat Loss）、力量举（Powerlifting）。
    *   **周频次**：3天/周、4天/周、5天/周、6天/周。
    *   **当前水平**：新手（<6个月）、中阶（6-24个月）、高阶（>24个月）。
*   **生成逻辑**：
    *   根据“推拉腿 (PPL)”、“上下肢”、“五分化”等经典模板，自动填充每日训练动作。
    *   Example: 若选“增肌”+“4天”，系统生成“周一：上肢推”、“周二：下肢”、“周四：上肢拉”、“周五：核心与有氧”。
*   **输出结果**：生成一份可编辑的周计划表，用户可手动微调。

#### 3.2.3 训练日志录入 (Workout Logger)
*   **功能描述**：核心业务功能，支持精细化的训练数据记录。
*   **基础记录结构**：
    *   选择动作 -> 添加组数 (Set) -> 输入重量 (kg) -> 输入次数 (Reps) -> 输入 RPE (1-10, 选填)。
*   **特色功能：超级组 (Superset)**：
    *   允许用户将两个或多个动作标记为“超级组”链接状态。
    *   UI 表现：在日志列表中，两个动作之间通过“链接链条”图标视觉连接。
*   **辅助工具**：
    *   **组间休息计时器**：完成一组后，自动弹出倒计时（默认90秒，可调）。
    *   **历史最佳提示**：在输入重量时，提示该动作的历史 PR (Personal Record) 供参考。

---

### 3.3 营养膳食 (Nutrition)

#### 3.3.1 食物热量库 (Food Database)
*   **功能描述**：提供中国常见食物及包装食品的营养数据查询。
*   **数据结构**：
    *   **基础信息**：名称、品牌（可选）、标准单位（100g/100ml/1份）。
    *   **核心营养素**：热量 (Kcal)、蛋白质 (g)、脂肪 (g)、碳水化合物 (g)。
*   **交互**：支持用户“自定义食物”，若库中没有，用户可手动录入并保存至“我的食物库”。

#### 3.3.2 饮食记录流 (Diet Journal)
*   **功能描述**：按时间轴记录每日摄入。
*   **餐次划分**：早餐、午餐、晚餐、加餐。
*   **实时计算器**：
    *   每添加一种食物，前端实时更新顶部的“今日仪表盘”。
    *   **对比视图**：
        *   左侧进度条：今日已摄入 (2200 Kcal)
        *   右侧目标线：目标代谢量 (2500 Kcal)
        *   差值提示：提示“还需摄入 300 Kcal”或“已超标 200 Kcal”（红色警告）。

---

### 3.4 日程日历 (Schedule)

#### 3.4.1 训练热力日历 (Heatmap Calendar)
*   **功能描述**：使用月视图日历展示用户的运动频率和状态。
*   **状态色块逻辑**：
    *   **绿色圆点**：当日有训练记录且已完成。
    *   **灰色圆点**：当日标记为“休息日”。
    *   **红色圆点**：当日计划了训练但未进行记录（缺勤）。
    *   **黄色圆点**：当日仅完成部分计划。
*   **交互**：点击日历中的某一天，侧边栏滑出该日的详细训练内容快照。

#### 3.4.2 打卡补签 (Makeup Check-in)
*   **功能描述**：允许用户对历史遗漏数据进行补充，但需记录补签标记。
*   **业务规则**：
    *   仅允许补签过去 7 天内的数据，超过 7 天不可修改，以保证数据的真实性。
    *   补签时必须填写“补签说明/备注”（如：忘记带手机、补录手写日志）。
    *   补签的数据在统计图中会带有特殊的“补”字角标。

---

### 3.5 社区与激励 (Social & Incentives)

#### 3.5.1 铁律龙虎榜 (Iron Leaderboard)
*   **功能描述**：全站用户的数据排名，激发竞争意识。
*   **榜单分类**：
    *   **力量榜 (The Hercules)**：按本周/本月“总举重吨位 (Total Volume)”倒序排列。
        *   *计算公式*：$\sum (Weight \times Reps \times Sets)$。
    *   **毅力榜 (The Grinder)**：按“连续打卡天数 (Streak)”倒序排列。
*   **隐私控制**：用户可在设置中选择“不参与排行榜”，此时其数据不公开，但仍可看别人排名。

#### 3.5.2 勋章墙 (Achievement Wall)
*   **功能描述**：基于事件触发的成就系统。
*   **勋章类型与触发条件**：
    *   **初出茅庐**：完成第1次训练打卡。
    *   **月度全勤**：单月内无缺勤记录。
    *   **深蹲达人**：累计深蹲总次数超过 1000 次。
    *   **吨位百万**：生涯总训练容量突破 1,000,000 kg。
*   **展示效果**：已获得的勋章为全彩高亮，未获得的为黑白锁定状态，点击可查看解锁条件。

---

### 3.6 后台管理 (Admin Management)

#### 3.6.1 用户权限管理 (RBAC)
*   **功能描述**：管理系统内部人员及注册会员的权限。
*   **角色定义**：
    *   **Super Admin**：拥有所有权限。
    *   **Content Editor**：仅能管理动作库、食物库、公告。
    *   **Normal User**：前台注册用户。
*   **操作**：封禁/解封用户（针对违规评论）、重置用户密码。

#### 3.6.2 敏感词过滤系统 (Content Safety)
*   **功能描述**：针对社区评论、用户昵称、自定义计划备注进行自动审查。
*   **实现机制**：
    *   维护一个“敏感词库 (Stop Words Dictionary)”。
    *   当用户提交文本时，后端拦截并进行正则匹配。
    *   若包含敏感词，直接拒绝提交并提示“包含非法字符”，或将敏感词替换为“***”。

#### 3.6.3 数据导入工具 (Data Import)
*   **功能描述**：用于快速初始化或批量更新基础数据。
*   **支持格式**：Excel (.xlsx) 或 CSV。
*   **场景**：
    *   批量导入食物热量数据（字段映射：Name, Calories, Protein...）。
    *   批量导入动作库数据。
*   **容错处理**：导入失败的行生成错误报告下载。

#### 3.6.4 操作日志审计 (Audit Logs)
*   **功能描述**：记录后台关键操作，确保责任可追溯。
*   **记录字段**：操作人ID、操作人IP、操作时间、模块（如：动作库）、动作（如：删除）、对象ID、变更前数据快照、变更后数据快照。

---

## 4. 非功能性需求 (Non-Functional Requirements)

1.  **响应性能**：首页仪表盘加载时间不超过 1.5秒；复杂图表渲染不超过 2秒。
2.  **并发能力**：支持至少 500 用户同时在线进行日志录入。
3.  **数据安全**：用户密码采用 BCrypt 加密存储；所有 API 接口需校验 JWT Token。
4.  **兼容性**：前端页面需响应式适配 Desktop (1920x1080) 及 Mobile (Web View)。

---

**(End of Document)**
